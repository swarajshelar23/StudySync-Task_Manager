<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StudySync Simple Demo</title>
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body>
    <main class="container">
      <h1>StudySync â€” Simple Demo</h1>
      <section id="app">
        <form id="addForm">
          <input id="title" placeholder="Task title" required />
          <button type="submit">Add</button>
        </form>
        <div id="status"></div>
        <ul id="tasks"></ul>
      </section>
    </main>
    <script>
      const apiBase = '/api/tasks'
      const tasksEl = document.getElementById('tasks')
      const statusEl = document.getElementById('status')

      async function fetchTasks(){
        const res = await fetch(apiBase)
        const data = await res.json()
        render(data)
      }

      function render(list){
        tasksEl.innerHTML = ''
        if (!list.length) tasksEl.innerHTML = '<li class="empty">No tasks</li>'
        list.forEach(t => {
          const li = document.createElement('li')
          li.innerHTML = `<strong>${t.title}</strong> <small>${t.status}</small> <button data-id="${t.id}" class="del">Delete</button>`
          tasksEl.appendChild(li)
        })
      }

      document.getElementById('addForm').addEventListener('submit', async (e)=>{
        e.preventDefault()
        const title = document.getElementById('title').value.trim()
        if(!title) return
        statusEl.textContent = 'Saving...'
        try{
          await fetch(apiBase, {method:'POST', headers:{'content-type':'application/json'}, body:JSON.stringify({title})})
          document.getElementById('title').value = ''
          statusEl.textContent = ''
          fetchTasks()
        }catch(err){
          statusEl.textContent = 'Error'
        }
      })

      tasksEl.addEventListener('click', async (e)=>{
        if(e.target.matches('.del')){
          const id = e.target.dataset.id
          await fetch(apiBase + '/' + id, {method:'DELETE'})
          fetchTasks()
        }
      })

      fetchTasks()
    </script>
  </body>
</html>
